<style>
  .mypage-item {
    width: 160px;
    height: 160px;
    background: rgba(0, 0, 0, 0.6);
    border: none;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    transition: transform 0.25s ease, box-shadow 0.25s ease;
    cursor: pointer;
  }
  .mypage-item:hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
  }
  .mypage-item.search-item.wide {
    width: 240px;
  }
  .mypage-icon {
    display: block;
    margin: 0 auto;
    max-width: 90%;
  }
  .mypage-text {
    margin-top: 0.5rem;
    color: #fff;
    font-size: 1rem;
    text-align: center;
  }
  .user-dropdown-wrapper {
    position: absolute;
    top: 20px;
    right: 20px;
    z-index: 1000;
  }
  .user-dropdown {
    display: inline-block;
    position: relative;
  }
  .user-bar {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: default;
  }
  .user-icon-placeholder {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
  }
  .dropdown-menu {
    display: none;
    background-color: #222;
    padding: 0.5rem;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    position: absolute;
    top: 100%;
    right: 0;
    min-width: 160px;
  }
  .user-dropdown:hover .dropdown-menu,
  .dropdown-menu:hover {
    display: block;
  }
  .dropdown-item {
    color: #fff;
    padding: 0.5rem;
    display: block;
    text-decoration: none;
  }
  .dropdown-item:hover {
    background-color: rgba(255, 255, 255, 0.1);
  }
</style>

<div class="container mt-5 position-relative">
  <div class="dj-icon" style="position:absolute; top:20px; left:20px; z-index:1000;">
    <%= image_tag "dj_robot_icon.png", alt: "DJ Robot", style: "width:60px; cursor:pointer;", onclick: "toggleAudio()" %>
    <div id="audioButtonIcon" style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); font-size:20px; color:#fff; pointer-events:none;">▶</div>
  </div>

  <% if user_signed_in? %>
    <div class="user-dropdown-wrapper">
      <div class="user-dropdown">
        <div class="user-bar">
          <% if current_user.avatar.attached? %>
            <%= image_tag current_user.avatar.variant(resize_to_fill:[32,32]).processed, class: "rounded-circle", alt: current_user.name %>
          <% else %>
            <%= image_tag "default_stick_figure.png", size: "32x32", class: "rounded-circle", alt: current_user.name %>
          <% end %>
          <span class="ms-2 text-white"><%= current_user.name %></span>
        </div>
        <div class="dropdown-menu">
          <%= link_to 'ログアウト', destroy_user_session_path, method: :delete, class: 'dropdown-item text-danger' %>
          <div class="dropdown-divider"></div>
          <%= link_to 'プロフィール編集', edit_user_registration_path, class: 'dropdown-item' %>
          <%= link_to 'マイページ', my_emotion_logs_path, class: 'dropdown-item' %>
          <%= link_to 'お気に入りリスト', bookmarks_emotion_logs_path, class: 'dropdown-item' %>
          <%= link_to 'お問い合わせ', '#', class: 'dropdown-item' %>
        </div>
      </div>
    </div>
  <% end %>
</div>


  <!-- ロゴ -->
  <div class="text-center mt-4">
    <%= link_to emotion_logs_path do %>
      <%= image_tag "logo1.png", alt: "Emotion List Logo", class: "img-fluid neon-icon", style: "max-width:700px; width:100%;" %>
    <% end %>
  </div>

  <!-- キャッチコピー -->
  <% unless user_signed_in? %>
    <div class="text-center mt-5 mb-4">
      <h1 style="font-size:3rem; font-weight:bold; color:rgb(215,205,216); text-shadow:0 0 10px,#1ee4da;">
        音楽とストレスを支配する
      </h1>
    </div>
  <% end %>

  <!-- メインメニュー -->
  <% if user_signed_in? %>
    <div class="d-flex justify-content-center align-items-stretch flex-wrap mt-4">
      <!-- ログアウト -->
      <div class="mypage-item">
        <%= link_to '#', id: 'logout-link', class: 'mypage-icon-link' do %>
          <%= image_tag 'log_out.png', alt: 'ログアウト', class: 'mypage-icon' %>
          <div class='mypage-text'>ログアウト</div>
        <% end %>
      </div>

      <!-- プロフィール編集 -->
      <div class="mypage-item">
        <%= link_to edit_user_registration_path, class: 'mypage-icon-link' do %>
          <%= image_tag 'profile_edit.png', alt: 'プロフィール編集', class: 'mypage-icon' %>
          <div class='mypage-text'>プロフィール編集</div>
        <% end %>
      </div>

      <!-- 検索Emotion -->
      <div class="mypage-item search-item wide">
        <%= form_with url: '#', method: :get, local: true do |f| %>
          <%= f.text_field :emotion, placeholder: 'Search by emotion', class: 'form-control' %>
        <% end %>
      </div>

      <!-- 検索Genre -->
      <div class="mypage-item search-item wide">
        <%= form_with url: '#', method: :get, local: true do |f| %>
          <%= f.text_field :genre, placeholder: 'Search by genre', class: 'form-control' %>
        <% end %>
      </div>

      <!-- マイページ -->
      <div class="mypage-item">
        <%= link_to my_emotion_logs_path, class: 'mypage-icon-link' do %>
          <%= image_tag 'mypage_logo.png', alt: 'マイページ', class: 'mypage-icon' %>
          <div class='mypage-text'>マイページ</div>
        <% end %>
      </div>

      <!-- お気に入り -->
      <div class="mypage-item">
        <%= link_to bookmarks_emotion_logs_path, class: 'mypage-icon-link' do %>
          <%= image_tag 'favorite.png', alt: 'お気に入りリスト', class: 'mypage-icon' %>
          <div class='mypage-text'>お気に入りリスト</div>
        <% end %>
      </div>
    </div>
  <% end %>

  <br><br>
</div>


