<style>
  .mypage-item {
    width: 160px;
    height: 160px;
    background: rgba(0, 0, 0, 0.6);
    border: none;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    transition: transform 0.25s ease, box-shadow 0.25s ease;
    cursor: pointer;
  }

  .mypage-item:hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
  }

  .mypage-item.search-item.wide {
    width: 240px;
  }

  .mypage-icon {
    display: block;
    margin: 0 auto;
    max-width: 90%;
  }

  .mypage-text {
    margin-top: 0.5rem;
    color: #fff;
    font-size: 1rem;
    text-align: center;
  }

  .user-dropdown-wrapper {
    position: absolute;
    top: 20px;
    right: 20px;
    z-index: 1000;
  }

  .user-dropdown {
    display: inline-block;
    position: relative;
  }

  .user-bar {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    cursor: default;
  }

  .user-bar img {
    width: 40px;
    height: 40px;
    border-radius: 50%;
  }

  .user-bar span {
    color: #fff;
    font-size: 1.1rem;
    font-weight: 500;
     box-shadow:
    0 4px 12px rgba(0, 0, 0, 0.4),
    0 0 12px rgba(230, 0, 255, 0.3),
    0 0 24px rgba(230, 0, 255, 0.2);
  }

  .dropdown-menu {
    display: none;
    background-color: #222;
    padding: 0.75rem;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    position: absolute;
    top: 100%;
    right: 0;
    min-width: 200px;
  }

  .user-dropdown:hover .dropdown-menu,
  .dropdown-menu:hover {
    display: block;
     box-shadow:
    0 4px 12px rgba(0, 0, 0, 0.4),
    0 0 12px rgba(230, 0, 255, 0.3),
    0 0 24px rgba(230, 0, 255, 0.2);
  }

  .dropdown-item {
    color: #fff;
    padding: 0.6rem 0.9rem;
    display: block;
    font-size: 1rem;
    text-decoration: none;
  }

  .dropdown-item:hover {
    background-color: rgba(255, 255, 255, 0.1);
    
  }

  .dj-icon-fixed {
    position: absolute;
    top: 20px;
    left: 20px;
    z-index: 2000;
  }

  .dj-icon-fixed img {
    width: 220px;     /* 好みに応じて調整可能 */
    height: auto;
    display: block;
  }

.mypage-item select.form-control {
  font-weight: bold;                     /* 文字を太く */
  color: #fff;                           /* 白文字に統一（任意） */
  background-color: #333;                /* ダーク背景 */
  border: 1px solid #666;                /* 枠線調整 */
  box-shadow: inset 0 1px 3px rgba(0,0,0,0.4); /* 内側の影で立体感 */

  transition: box-shadow 0.25s ease, border-color 0.25s ease;
}

.mypage-item select.form-control:hover {
  box-shadow:
    0 0 6px rgba(230, 0, 255, 0.5),
    0 0 12px rgba(230, 0, 255, 0.3);     /* 紫がかったネオン風 */
  border-color: rgba(230, 0, 255, 0.6);  /* 境界線も光るように */
  cursor: pointer;
}

.mypage-item input.form-control[type="text"] {
  font-weight: bold;
  color: #fff;                              /* ← 文字を白に */
  background-color: #333;                   /* ダーク背景 */
  border: 1px solid #666;
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.4);

  transition: box-shadow 0.25s ease, border-color 0.25s ease;
}

.mypage-item input.form-control[type="text"]::placeholder {
  color: #aaa;                              /* プレースホルダーは淡いグレーに */
}

.mypage-item input.form-control[type="text"]:hover,
.mypage-item input.form-control[type="text"]:focus {
  box-shadow:
    0 0 6px rgba(0, 170, 255, 0.5),
    0 0 12px rgba(0, 170, 255, 0.3);         /* 青く光るエフェクト */
  border-color: rgba(0, 170, 255, 0.6);
  outline: none;
}

/* 入力欄の下角を削る */
.no-bottom-radius {
  border-bottom-left-radius: 0 !important;
  border-bottom-right-radius: 0 !important;
}

/* 候補リストの上角を削る + デザイン */
.tag-suggestions {
  border-top-left-radius: 0;
  border-top-right-radius: 0;
  background-color: #222;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.mypage-item.search-item.wide {
  overflow: visible;
  height: auto;
  min-height: 160px;
}


</style>


<div class="container mt-5 position-relative">
<div class="dj-icon-fixed">
  <%= image_tag "dj_robot_icon.png", alt: "DJ Robot" %>
</div>



  <% if user_signed_in? %>
    <div class="user-dropdown-wrapper">
      <div class="user-dropdown">
        <div class="user-bar">
          <% if current_user.avatar.attached? %>
            <%= image_tag current_user.avatar.variant(resize_to_fill:[32,32]).processed, class: "rounded-circle", alt: current_user.name %>
          <% else %>
            <%= image_tag "default_stick_figure.png", size: "32x32", class: "rounded-circle", alt: current_user.name %>
          <% end %>
          <span class="ms-2 text-white"><%= current_user.name %></span>
        </div>
        <div class="dropdown-menu">
          <%= link_to 'ログアウト', destroy_user_session_path, method: :delete, class: 'dropdown-item text-danger' %>
          <div class="dropdown-divider"></div>
          <%= link_to 'プロフィール編集', edit_user_registration_path, class: 'dropdown-item' %>
          <%= link_to 'マイページ', my_emotion_logs_path, class: 'dropdown-item' %>
          <%= link_to 'お気に入りリスト', bookmarks_emotion_logs_path, class: 'dropdown-item' %>
          <%= link_to 'お問い合わせ', '#', class: 'dropdown-item' %>
        </div>
      </div>
    </div>
  <% end %>
</div>


  <!-- ロゴ -->
  <div class="text-center mt-4">
    <%= link_to emotion_logs_path do %>
      <%= image_tag "logo1.png", alt: "Emotion List Logo", class: "img-fluid neon-icon", style: "max-width:700px; width:100%;" %>
    <% end %>
  </div>

  <!-- キャッチコピー -->
 <% unless user_signed_in? %>
  <!-- キャッチコピー -->
  <div class="text-center mt-5 mb-4">
    <h1 style="font-size:3rem; font-weight:bold; color:rgb(215,205,216); text-shadow:0 0 10px,#1ee4da;">
      音楽とストレスを支配する
    </h1>
  </div>

  <!-- Neon ボタン群（ログイン前） -->
  <div class="neon-btn-panel text-center mt-4">
    <%= link_to "https://soundcloud.com/signup",
                target: "_blank",
                rel: "noopener",
                class: "neon-btn btn-neon-xl me-3" do %>
      <div class="neon-btn-title">新規作成</div>
      <div class="neon-btn-sub">(SoundCloudアカウントも簡単作成)</div>
    <% end %>

    <%= link_to user_soundcloud_omniauth_authorize_path,
                class: "neon-btn btn-neon-xl" do %>
      <div class="neon-btn-title">ログインして始める</div>
    <% end %>
  </div>

  <div class="neon-btn-footer large-text text-center mt-2">
    <strong>※ はじめての方は新規作成で登録後、<br>
    この画面に戻って「ログインして始める」をクリックしてください。</strong>
  </div>
<% end %>


  <!-- メインメニュー -->
  <% if user_signed_in? %>
    <div class="d-flex justify-content-center align-items-stretch flex-wrap mt-4">
      <!-- ログアウト -->
      <div class="mypage-item">
        <%= link_to '#', id: 'logout-link', class: 'mypage-icon-link' do %>
          <%= image_tag 'log_out.png', alt: 'ログアウト', class: 'mypage-icon' %>
          <div class='mypage-text'>ログアウト</div>
        <% end %>
      </div>

      <!-- プロフィール編集 -->
      <div class="mypage-item">
        <%= link_to edit_user_registration_path, class: 'mypage-icon-link' do %>
          <%= image_tag 'profile_edit.png', alt: 'プロフィール編集', class: 'mypage-icon' %>
          <div class='mypage-text'>プロフィール編集</div>
        <% end %>
      </div>

<div class="d-flex justify-content-center align-items-start flex-wrap mt-4" style="gap: 1rem;">
  <!-- EMOTION -->
  <div class="mypage-item search-item wide">
    <div style="color: magenta; font-weight: bold; font-size: 1rem; margin-bottom: 0.3rem; text-align: center;">
      EMOTION
    </div>
    <%= form_with url: emotion_logs_path, method: :get, local: true do |f| %>
      <%= select_tag :emotion,
                     options_for_select(
                       [['選択しない', ''], ['最高', '最高'], ['気分良い', '気分良い'],
                        ['いつも通り', 'いつも通り'], ['イライラ', 'イライラ'], ['限界', '限界']],
                     selected: params[:emotion]
                     ),
                     class: 'form-control',
                     onchange: 'this.form.submit()' %>
      <%= hidden_field_tag :genre, params[:genre] %>
    <% end %>
  </div>

<!-- 中央の「同士を探す」 -->
<div class="mypage-item d-flex justify-content-center <div class="mypage-item d-flex flex-column justify-content-center align-items-center"
     style="width: 160px; height: 160px; background: rgba(0, 0, 0, 0.6); border-radius: 8px; box-shadow: none; cursor: default;">
  
  <span style="color: #ff66cc; font-weight: bold; font-size: 1.1rem; text-shadow: 0 0 8px rgba(255, 102, 204, 0.5); text-align: center;">
    ←同士を探す→
  </span>

  <%= link_to '検索リセット', emotion_logs_path,
              class: 'btn btn-sm mt-2',
              style: 'color: #fff; background-color: #555;
                      border: none; border-radius: 20px;
                      padding: 0.3rem 0.7rem;
                      text-shadow: 0 0 6px #f0f;
                      transition: all 0.2s ease;' %>
<%# ↑ ボタン風リンクとして実装 %>
</div>


  <!-- TAG -->
<div class="mypage-item search-item wide"
     data-controller="tag-autocomplete"
     style="position: relative;">
  <div style="color: #00aaff; font-weight: bold; font-size: 1rem; margin-bottom: 0.3rem; text-align: center;">
    TAG
  </div>

  <%= form_with url: emotion_logs_path, method: :get, local: true do |f| %>
    <%= f.text_field :genre,
                     placeholder: 'Search by genre',
                     class: 'form-control no-bottom-radius',
                     value: params[:genre],
                     autocomplete: 'off',
                     data: { tag_autocomplete_target: "input" } %>
    <%= hidden_field_tag :emotion, params[:emotion] %>
  <% end %>

  <!-- 候補リスト -->
<ul
  data-tag-autocomplete-target="suggestions"
  class="list-group tag-suggestions"
  style="position: absolute;
         bottom: calc(100% - 2px); /* ← ← ← 食い込ませる */
         left: 0;
         width: 100%;
         z-index: 9999;
         margin: 0;">
</ul>

</div>



</div>








      <!-- マイページ -->
      <div class="mypage-item">
        <%= link_to my_emotion_logs_path, class: 'mypage-icon-link' do %>
          <%= image_tag 'mypage_logo.png', alt: 'マイページ', class: 'mypage-icon' %>
          <div class='mypage-text'>マイページ</div>
        <% end %>
      </div>

      <!-- お気に入り -->
      <div class="mypage-item">
        <%= link_to bookmarks_emotion_logs_path, class: 'mypage-icon-link' do %>
          <%= image_tag 'favorite.png', alt: 'お気に入りリスト', class: 'mypage-icon' %>
          <div class='mypage-text'>お気に入りリスト</div>
        <% end %>
      </div>
    </div>
  <% end %>

  <br><br>
</div>


