<%# app/views/shared/_notification_push_toggle.html.erb %>

<%# モバイルでは一切表示しないガード %>
<% if defined?(mobile_device?) && mobile_device? %>
  <%# モバイルは何も描画しない %>
<% else %>
  <%# ここでは Turbo Frame を書かない。
      「フレームの中に入る中身（リンク）」だけを描画する。 %>

  <% if current_user.respond_to?(:push_enabled) && current_user.push_enabled? %>
    <%# === 通知 ON のとき：OFF にするリンクだけ === %>
    <%= link_to disable_push_notifications_path,
                method: :patch,
                class: "dropdown-item d-flex align-items-center text-warning",
                data: {
                  turbo_method: :patch,
                  turbo_frame:  "notification-push-toggle-desktop"  # ← このフレームだけを差し替える
                } do %>
      <%= image_tag "bell_on.webp", class: "dropdown-icon me-2", alt: "" %> 通知をオフにする
    <% end %>

  <% else %>
    <%# === 通知 OFF のとき：ON にするリンクだけ === %>
    <%= link_to enable_push_notifications_path,
                method: :patch,
                class: "dropdown-item d-flex align-items-center text-primary",
                data: {
                  turbo_method: :patch,
                  turbo_frame:  "notification-push-toggle-desktop"
                } do %>
      <%= image_tag "bell_off.webp", class: "dropdown-icon me-2", alt: "" %> 通知をオンにする
    <% end %>
  <% end %>
<% end %>
