<div class="container mt-5">
  <h1 class="text-center mt-4">
    <i class="bi bi-heart-pulse"></i>Record emotions<i class="bi bi-heart-pulse"></i>
  </h1>

  <div class="row justify-content-center">
    <div class="col-md-8">
<%= form_with model: @emotion_log, id: "emotion-form", local: true, data: { turbo: false } do |form| %>
        <div class="mb-4">
          <%= form.label :date, '日付' %>
          <%= form.date_field :date, class: 'form-control', max: Date.today.to_s %>

        </div>
        <div class="mb-4">
          <%= form.label :emotion, '感情' %>
          <%= form.select :emotion,
            [['めちゃくちゃ気分良い', 'めちゃくちゃ気分良い'],
             ['気分良い', '気分良い'],
             ['いつも通り', 'いつも通り'],
             ['イライラ', 'イライラ'],
             ['限界', '限界']], {}, class: 'form-control' %>
        </div>

<!-- ▼ ここから検索欄をまとめてラップする -->
<!-- 音楽検索のセクション -->
<div id="search-section">
  <div class="mb-4">
    <label for="music-search">今日の音楽を検索しようぜ</label>
    <input type="text" id="music-search" class="form-control" placeholder="キーワードを入力">
    <button type="button" id="search-button" class="btn btn-primary mt-2">検索</button>

  </div>

  <p id="search-status" style="color: rgb(255, 185, 241); font-weight: bold;"></p>

  <!-- ローディングインジケータ -->
  <div class="pacman-wrapper">
    <div id="loading-indicator" class="circle-packman-1" style="display: none;"></div>
  </div>

  <!-- 検索結果表示エリア -->
  <div id="search-results"></div>

  <!-- ページネーションボタン表示先 -->
  <div id="pagination-controls" class="d-flex justify-content-center mt-3"></div>
</div>


<!-- 隠しフィールド(既存) -->
<input type="hidden" id="selected-audio" name="emotion_log[music_url]" value="">

<!-- "選択した曲名" を表示するフィールド(オプション) -->
<div class="mb-4">
  <%= form.label :track_name, "選択した曲名" %>
  <%= form.text_field :track_name, id: "selected-track", class: "form-control" %>
</div>
<div id="soundcloud-player-container" class="mt-3"></div>

<!-- ...他のフォーム要素... -->

        <div class mb-4>
        <%= form.label :description, '一言 吐いてみて' %>
        <%= form.text_field :description, class: 'form-control' %>
        </div>

        <div class="d-flex justify-content-center">
          <%= form.submit '記録する', class: 'btn btn-primary' %>
        </div>
      <% end %>
      <%= link_to '一覧に戻る', root_path, class: 'btn btn-secondary mt-3' %>
    </div>
  </div>

 
<!-- SoundCloudのアクセストークンをJavaScriptに渡す -->
<script type="text/javascript">
  window.soundcloudToken = "<%= current_user.soundcloud_token %>";
</script>