<!DOCTYPE html>
<html>
<head>
  <title><%= content_for(:title) || "EMOTION MUSIC BOX" %></title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>

  <%= favicon_link_tag 'favicon.ico' %>
  <% og_image = image_url('ogp.png') %>
  <meta property="og:title" content="Emotion Music Box (EMOMU)">
  <meta property="og:description" content="ÊÑüÊÉÖ„Å®Èü≥Ê•Ω„Çí„Ç∑„Çß„Ç¢„Åô„ÇãÊñ∞ÊÑüË¶ö„Ç¢„Éó„É™">
  <meta property="og:image" content="<%= og_image %>">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://moriappli-emotion.com">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Emotion Music Box (EMOMU)">
  <meta name="twitter:description" content="ÊÑüÊÉÖ„Å®Èü≥Ê•Ω„Çí„Ç∑„Çß„Ç¢„Åô„ÇãÊñ∞ÊÑüË¶ö„Ç¢„Éó„É™">
  <meta name="twitter:image" content="<%= og_image %>">
  <meta name="twitter:url" content="https://moriappli-emotion.com">
<!-- app/views/layouts/application.html.erb „ÅÆ head ÂÜÖ -->
<meta name="soundcloud-client-id"   content="<%= ENV['SOUNDCLOUD_CLIENT_ID'] %>">
<% if current_user&.soundcloud_token.present? %>
  <meta name="soundcloud-oauth-token" content="<%= current_user.soundcloud_token %>">
<% end %>

  <script src="https://connect.soundcloud.com/sdk/sdk-3.3.2.js"></script>

  <!-- ‚ë† DNS „É´„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„ÇíÂÖàË°å -->
<link rel="dns-prefetch" href="https://w.soundcloud.com">
<link rel="dns-prefetch" href="https://api.soundcloud.com">

<!-- ‚ë° TLS „Éè„É≥„Éâ„Ç∑„Çß„Ç§„ÇØ„ÇÇÂÖàË°å -->
<link rel="preconnect" href="https://w.soundcloud.com" crossorigin>
<link rel="preconnect" href="https://api.soundcloud.com" crossorigin>

<!-- ‚ë¢ Widget API „Çπ„ÇØ„É™„Éó„ÉàËá™‰Ωì„ÇíÊúÄÂÑ™ÂÖà„Åß„Éó„É™„É≠„Éº„Éâ -->
<link rel="preload" as="script" href="https://w.soundcloud.com/player/api.js">


  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 1. SoundCloud Widget API „ÇíÊúÄÂÑ™ÂÖà„ÅßË™≠„ÅøËæº„ÇÄÔºàdefer„Å™„ÅóÔºâ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <script src="https://w.soundcloud.com/player/api.js"></script>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 2. Rails „ÅÆ application.js „ÇíË™≠„ÅøËæº„ÇÄÔºàStimulus „ÇÑ‰ªñ„ÅÆ JSÔºâ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <%= javascript_include_tag "application", "data-turbo-track": "reload", type: "module", defer: true %>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 3. CSS & Â§ñÈÉ®„É©„Ç§„Éñ„É©„É™ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <%= stylesheet_link_tag "application", "data-turbo-track": "reload", media: "all" %>
  <!-- Font AwesomeÔºàÂÜçÁîüÔºèÂÅúÊ≠¢„Ç¢„Ç§„Ç≥„É≥Áî®„Å™„Å©Ôºâ -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  
  <!-- GSAP, SweetAlert2, Axios, Bootstrap IconsÔºà„Åô„Åπ„Å¶ defer „ÅßË™≠„ÅøËæº„ÇÄÔºâ -->
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.8/axios.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

  <%= yield :head %>
</head>

<body data-controller="view-switcher global-player" data-flash-notice="<%= j flash[:notice] %>"
      data-flash-alert="<%= j flash[:alert] %>">
  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ „É≠„Éº„Éá„Ç£„É≥„Ç∞ÁîªÈù¢ÔºàÁúÅÁï•„Åõ„ÅöÂÖ®‰Ωì„ÇíËºâ„Åõ„Åæ„ÅôÔºâ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div id="screen-cover-loading" aria-live="polite" aria-label="„É≠„Éº„Éá„Ç£„É≥„Ç∞ÁîªÈù¢">
    <div class="pacman-wrapper" aria-hidden="true">
      <div class="circle-packman-1"></div>
      <div class="loading-text">Now Loading...</div>
    </div>
  </div>

  <div id="flash-message" style="display:none;position:fixed;top:0;left:0;right:0;z-index:9999;padding:1em;background:#333;color:#fff;text-align:center;"></div>

  <turbo-frame id="modal-container"></turbo-frame>
  <turbo-frame id="playlist-modal-container"></turbo-frame>

  <!-- „Éá„Éê„ÉÉ„Ç∞È†òÂüüÔºàÂøÖË¶Å„Å´Âøú„Åò„Å¶„Ç¢„É≥„Ç≥„É°„É≥„ÉàÔºâ -->
  <!-- <p>üîç Debug: <%= current_user.inspect %></p> -->

  <div id="comment-container"></div>
  <div id="flash" class="position-fixed top-0 start-50 translate-middle-x mt-4 zindex-tooltip"></div>
  <%= render "shared/flash_container" %>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ „Éò„ÉÉ„ÉÄ„Éº & „Ç≥„É≥„ÉÜ„É≥„ÉÑ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <%= yield %>
  <%= render 'shared/footer' %>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‰∏ãÈÉ®„Ç´„Çπ„Çø„É†„Éó„É¨„Éº„É§„Éº & Èö†„Åó iframe ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->

  <!-- 1) SoundCloud „ÅÆ iframeÔºàdisplay: none „ÅßÈö†„ÅôÔºâ -->
  <iframe
    id="hidden-sc-player"
    src=""
    style="display: none;"
    allow="autoplay"
    frameborder="no"
    scrolling="no"
    width="100%" height="166"
  ></iframe>

  <!-- 2) ‰∏ãÈÉ®Âõ∫ÂÆö„ÅÆ„Ç´„Çπ„Çø„É†„Éó„É¨„Éº„É§„Éº UI -->
  <div id="bottom-player"
     class="d-none"
     style="
       position: fixed;
       bottom: 0;
       left: 0;
       right: 0;
       background: #222;
       color: #fff;
       display: flex;
       align-items: center;
       padding: 8px 16px;
       z-index: 1000;
     ">
  <!-- ÂÜçÁîüÔºèÂÅúÊ≠¢„Éú„Çø„É≥ -->
<button id="play-pause-button"
          class="btn btn-link text-white me-3"
          data-action="click->global-player#togglePlayPause"
          style="font-size:24px;padding:0;border:none;background:none;position:relative;width:40px;height:40px;">
    <i id="play-pause-icon" class="fa fa-play"></i>
    <!-- „É≠„Éº„Éá„Ç£„É≥„Ç∞ÊôÇ„Å†„ÅëË°®Á§∫ -->
    <span id="play-btn-spinner" style="display:none;position:absolute;left:0;top:0;width:40px;height:40px;">
      <!-- „Åì„Åì„Å´„Åê„Çã„Åê„Çã„Çπ„Éî„Éä„Éº„ÇÑ„Ç≠„É£„É©SVG„Å™„Å©„ÇíÂÖ•„Çå„Å¶„ÇÇOK -->
      <span class="loading-spinner-inline"></span>
    </span>
  </button>

  <!-- Êõ≤ÊÉÖÂ†±Ôºà„Çø„Ç§„Éà„É´„Éª„Ç¢„Éº„ÉÜ„Ç£„Çπ„ÉàÔºâ -->
  <!-- ‚Üì‰∏ãÈÉ®„Ç´„Çπ„Çø„É†„Éó„É¨„Éº„É§„ÉºUI„ÅÆÊõ≤ÊÉÖÂ†±ÈÉ®ÂàÜ„Å†„Åë‰øÆÊ≠£ÁâàÔºà„Éù„Ç§„É≥„Éà„ÅØ‚òÖÂç∞Ôºâ -->
<div id="track-info"
     style="flex: 1; overflow: hidden; white-space: nowrap; display: flex; align-items: center; padding-left: 12px;">
  <!-- „Çπ„Éî„Éä„ÉºÔºàÂ∑¶Á´ØÔºâ -->
  <span class="loading-spinner-inline" id="loading-spinner" style="display: none; width: 24px; height: 24px; margin-right: 8px; vertical-align: middle;"></span>
  <!-- Now Loading... -->
  <span id="track-title" style="font-weight: 600;">
    <!-- JS„ÅßÊ≥¢„Ç¢„Éã„É°ÊñáÂ≠ó„ÇíinnerHTML„Å´ÂÖ•„Çå„ÇãÊÉ≥ÂÆö -->
    <span class="neon-wave">
      <span>N</span><span>O</span><span>W</span>
      <span>&nbsp;</span>
      <span>L</span><span>O</span><span>A</span><span>D</span><span>I</span><span>N</span><span>G</span>
      <span>.</span><span>.</span><span>.</span>
    </span>
  </span>
  <!-- „Ç≠„É£„É©„ÇØ„Çø„Éº -->
  <span class="neon-character-spinbox" style="vertical-align: middle; margin-left: 8px;">
    <span class="neon-body">
      <span class="neon-eye neon-eye-left"></span>
      <span class="neon-eye neon-eye-right"></span>
      <span class="neon-arm neon-arm-left"></span>
      <span class="neon-arm neon-arm-right"></span>
      <span class="neon-leg neon-leg-left"></span>
      <span class="neon-leg neon-leg-right"></span>
    </span>
  </span>
  <!-- „Ç¢„Éº„ÉÜ„Ç£„Çπ„ÉàÂêçÔºàÊõ≤„ÅåÊù•„ÅüÊôÇÁî®Ôºâ -->
  <small id="track-artist" style="color: #bbb; margin-left: 8px;"></small>
</div>



    <!-- „Ç∑„Éº„ÇØÔºèÊôÇÈñìË°®Á§∫ -->
    <div style="flex: 3; display: flex; align-items: center; gap: 8px; margin-left: 16px;">
      <!-- ÁµåÈÅéÊôÇÈñì -->
      <span id="current-time" style="min-width: 40px;">0:00</span>

      <!-- „Ç∑„Éº„ÇØ„Éê„Éº -->
      <input id="seek-bar"
             type="range"
             min="0" max="100" value="0"
             style="
               flex: 1;
               appearance: none;
               height: 4px;
               background: #555;
               border-radius: 2px;
               outline: none;
             "
             data-action="input->global-player#seek"
      >

      <!-- Á∑èÊôÇÈñì -->
      <span id="duration" style="min-width: 40px;">0:00</span>
    </div>

    <!-- Èü≥Èáè„Çπ„É©„Ç§„ÉÄ„Éº -->
    <div style="display: flex; align-items: center; gap: 8px; margin-left: 16px;">
      <i class="fa fa-volume-up" style="color: #fff;"></i>
      <input id="volume-bar"
             type="range"
             min="0" max="100" value="100"
             style="
               width: 80px;
               appearance: none;
               height: 4px;
               background: #555;
               border-radius: 2px;
               outline: none;
             "
             data-action="input->global-player#changeVolume"
      >
    </div>
  </div>
</body>
</html>


<style>

  #bottom-player {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 99999 !important;
  /* ‰ªñ„ÅØÂêå„Åò */
}


.neon-character-spinbox {
  display: inline-block;
  width: 48px; height: 48px;
  position: relative;
}
.neon-body {
  width: 32px; height: 32px;
  border-radius: 50%;
  background: radial-gradient(circle at 60% 40%, #10ffec 60%, #073753 100%);
  box-shadow: 0 0 16px 4px #1efff7;
  position: absolute;
  left: 8px; top: 8px;
  animation: neon-bounce 0.7s cubic-bezier(.5,0,.5,1) infinite alternate;
}
@keyframes neon-bounce {
  0%   { top: 8px;    transform: scaleY(1); }
  10%  { top: 0px;    transform: scaleY(1.12); }
  15%  { top: -4px;   transform: scaleY(1.1); }
  25%  { top: -14px;  transform: scaleY(0.94);}
  45%  { top: -22px;  transform: scaleY(1);}
  50%  { top: -24px;  transform: scaleY(1.08);}
  60%  { top: -12px;  transform: scaleY(0.96);}
  80%  { top: 0px;    transform: scaleY(1.05);}
  100% { top: 8px;    transform: scaleY(1);}
}
/* ÁõÆ */
.neon-eye {
  position: absolute;
  top: 12px;
  width: 5px; height: 5px;
  background: #fff;
  border-radius: 50%;
  opacity: 0.8;
  box-shadow: 0 0 4px #0ff;
}
.neon-eye-left  { left: 7px; }
.neon-eye-right { left: 16px; }

/* Êâã */
.neon-arm {
  position: absolute;
  top: 16px; width: 10px; height: 4px;
  background: #00ffe9;
  border-radius: 4px;
  box-shadow: 0 0 4px #2fffcf;
}
.neon-arm-left  { left: -7px;  transform: rotate(-35deg);}
.neon-arm-right { right: -7px; transform: rotate(35deg);}

/* Ë∂≥ */
.neon-leg {
  position: absolute;
  bottom: 0; width: 7px; height: 3px;
  background: #00ffe9;
  border-radius: 3px;
  box-shadow: 0 0 4px #2fffcf;
  /* Ë∑≥„Å≠„ÅÆ„Çø„Ç§„Éü„É≥„Ç∞„ÅßÂãï„Åã„Åô */
  animation: leg-run 0.7s linear infinite alternate;
}
.neon-leg-left  { left: 6px;  animation-delay: 0s; }
.neon-leg-right { right: 6px; animation-delay: 0.35s;}
@keyframes leg-run {
  0%   { transform: rotate(40deg) translateY(2px);}
  40%  { transform: rotate(-25deg) translateY(0);}
  50%  { transform: rotate(-25deg) translateY(2px);}
  100% { transform: rotate(40deg) translateY(2px);}
}

.loading-spinner-inline {
  min-width: 24px;
  width: 24px;
  height: 24px;
  padding-left: 2px; /* „Åª„Çì„ÅÆÂ∞ë„Åó‰ΩôÁôΩ„ÇíË∂≥„Åô */
  box-sizing: content-box;
}
</style>