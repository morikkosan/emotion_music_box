<!DOCTYPE html>
<html>
<head>
  <title><%= content_for(:title) || "EMOTION MUSIC BOX" %></title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>

  <%= favicon_link_tag 'favicon.ico' %>
  <% og_image = image_url('ogp.png') %>
  <meta property="og:title" content="Emotion Music Box (EMOMU)">
  <meta property="og:description" content="ÊÑüÊÉÖ„Å®Èü≥Ê•Ω„Çí„Ç∑„Çß„Ç¢„Åô„ÇãÊñ∞ÊÑüË¶ö„Ç¢„Éó„É™">
  <meta property="og:image" content="<%= og_image %>">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://moriappli-emotion.com">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Emotion Music Box (EMOMU)">
  <meta name="twitter:description" content="ÊÑüÊÉÖ„Å®Èü≥Ê•Ω„Çí„Ç∑„Çß„Ç¢„Åô„ÇãÊñ∞ÊÑüË¶ö„Ç¢„Éó„É™">
  <meta name="twitter:image" content="<%= og_image %>">
  <meta name="twitter:url" content="https://moriappli-emotion.com">

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 1. SoundCloud Widget API „ÇíÊúÄÂÑ™ÂÖà„ÅßË™≠„ÅøËæº„ÇÄÔºàdefer„Å™„ÅóÔºâ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <script src="https://w.soundcloud.com/player/api.js"></script>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 2. Rails „ÅÆ application.js „ÇíË™≠„ÅøËæº„ÇÄÔºàStimulus „ÇÑ‰ªñ„ÅÆ JSÔºâ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <%= javascript_include_tag "application", "data-turbo-track": "reload", type: "module", defer: true %>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 3. CSS & Â§ñÈÉ®„É©„Ç§„Éñ„É©„É™ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <%= stylesheet_link_tag "application", "data-turbo-track": "reload", media: "all" %>
  <!-- Font AwesomeÔºàÂÜçÁîüÔºèÂÅúÊ≠¢„Ç¢„Ç§„Ç≥„É≥Áî®„Å™„Å©Ôºâ -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <!-- GSAP, SweetAlert2, Axios, Bootstrap IconsÔºà„Åô„Åπ„Å¶ defer „ÅßË™≠„ÅøËæº„ÇÄÔºâ -->
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.8/axios.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

  <%= yield :head %>
</head>

<body data-controller="view-switcher" data-flash-notice="<%= j flash[:notice] %>"
      data-flash-alert="<%= j flash[:alert] %>">
  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ „É≠„Éº„Éá„Ç£„É≥„Ç∞ÁîªÈù¢ÔºàÁúÅÁï•„Åõ„ÅöÂÖ®‰Ωì„ÇíËºâ„Åõ„Åæ„ÅôÔºâ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div id="screen-cover-loading" aria-live="polite" aria-label="„É≠„Éº„Éá„Ç£„É≥„Ç∞ÁîªÈù¢">
    <div class="pacman-wrapper" aria-hidden="true">
      <div class="circle-packman-1"></div>
      <div class="loading-text">Now Loading...</div>
    </div>
  </div>

  <div id="flash-message" style="display:none;position:fixed;top:0;left:0;right:0;z-index:9999;padding:1em;background:#333;color:#fff;text-align:center;"></div>

  <turbo-frame id="modal-container"></turbo-frame>
  <turbo-frame id="playlist-modal-container"></turbo-frame>

  <!-- „Éá„Éê„ÉÉ„Ç∞È†òÂüüÔºàÂøÖË¶Å„Å´Âøú„Åò„Å¶„Ç¢„É≥„Ç≥„É°„É≥„ÉàÔºâ -->
  <!-- <p>üîç Debug: <%= current_user.inspect %></p> -->

  <div id="comment-container"></div>
  <div id="flash" class="position-fixed top-0 start-50 translate-middle-x mt-4 zindex-tooltip"></div>
  <%= render "shared/flash_container" %>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ „Éò„ÉÉ„ÉÄ„Éº & „Ç≥„É≥„ÉÜ„É≥„ÉÑ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <%= yield %>
  <%= render 'shared/footer' %>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‰∏ãÈÉ®„Ç´„Çπ„Çø„É†„Éó„É¨„Éº„É§„Éº & Èö†„Åó iframe ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->

  <!-- 1) SoundCloud „ÅÆ iframeÔºàdisplay: none „ÅßÈö†„ÅôÔºâ -->
  <iframe
    id="hidden-sc-player"
    src=""
    style="display: none;"
    allow="autoplay"
    frameborder="no"
    scrolling="no"
    width="100%" height="166"
  ></iframe>

  <!-- 2) ‰∏ãÈÉ®Âõ∫ÂÆö„ÅÆ„Ç´„Çπ„Çø„É†„Éó„É¨„Éº„É§„Éº UI -->
  <div id="bottom-player"
       class="d-none"
       style="
         position: fixed;
         bottom: 0;
         left: 0;
         right: 0;
         background: #222;
         color: #fff;
         display: flex;
         align-items: center;
         padding: 8px 16px;
         z-index: 1000;
       "
       data-controller="global-player">
    <!-- ÂÜçÁîüÔºèÂÅúÊ≠¢„Éú„Çø„É≥ -->
    <button id="play-pause-button"
            class="btn btn-link text-white me-3"
            data-action="click->global-player#togglePlayPause"
            style="font-size: 24px; padding: 0; border: none; background: none;">
      <i id="play-pause-icon" class="fa fa-play"></i>
    </button>

    <!-- Êõ≤ÊÉÖÂ†±Ôºà„Çø„Ç§„Éà„É´„Éª„Ç¢„Éº„ÉÜ„Ç£„Çπ„ÉàÔºâ -->
    <div id="track-info" style="flex: 1; overflow: hidden; white-space: nowrap;">
      <span id="track-title" style="font-weight: 600;">‚Äî</span>
      <small id="track-artist" style="color: #bbb; margin-left: 8px;"></small>
    </div>

    <!-- „Ç∑„Éº„ÇØÔºèÊôÇÈñìË°®Á§∫ -->
    <div style="flex: 3; display: flex; align-items: center; gap: 8px; margin-left: 16px;">
      <!-- ÁµåÈÅéÊôÇÈñì -->
      <span id="current-time" style="min-width: 40px;">0:00</span>

      <!-- „Ç∑„Éº„ÇØ„Éê„Éº -->
      <input id="seek-bar"
             type="range"
             min="0" max="100" value="0"
             style="
               flex: 1;
               appearance: none;
               height: 4px;
               background: #555;
               border-radius: 2px;
               outline: none;
             "
             data-action="input->global-player#seek"
      >

      <!-- Á∑èÊôÇÈñì -->
      <span id="duration" style="min-width: 40px;">0:00</span>
    </div>

    <!-- Èü≥Èáè„Çπ„É©„Ç§„ÉÄ„Éº -->
    <div style="display: flex; align-items: center; gap: 8px; margin-left: 16px;">
      <i class="fa fa-volume-up" style="color: #fff;"></i>
      <input id="volume-bar"
             type="range"
             min="0" max="100" value="100"
             style="
               width: 80px;
               appearance: none;
               height: 4px;
               background: #555;
               border-radius: 2px;
               outline: none;
             "
             data-action="input->global-player#changeVolume"
      >
    </div>
  </div>
</body>
</html>
