// すべての @use はファイルの本当の先頭に！コメントもOK
@use "bootstrap/scss/bootstrap";
@use "bootstrap-icons/font/bootstrap-icons";
@use "components/floating_button";
@use "components/neon_buttons" as *;
@use "custom_styles";
@use "index_logs";
@use "modal_styles";
@use "mobile_apps";
@use "application_index";
@use "new_html";
@use "playlist_music";
@use "show_html";
@use "profile_styles";
@use "nokori_styles";
@use "swal_flash_craft";
@use "music_player";

// ✅ Bootswatch(Cyborg)のCDN取り込みは一旦停止（重複読み込みを回避）
//   見た目だけの差分で、機能・クラスはそのまま。
// @import url("https://cdn.jsdelivr.net/npm/bootswatch@5.3.0/dist/cyborg/bootstrap.min.css");

.view-hidden {
  display: none !important;
  opacity: 0 !important;
  visibility: hidden !important;
  height: 0 !important;
  pointer-events: none !important;
}

// html.preload body { visibility: hidden; }

.mobile-only { display: none !important; }
.desktop-only { display: block !important; }

@media (max-width: 768px) {
  .desktop-only { display: none !important; }
  .mobile-only { display: block !important; }
}

body.modal-open #bottom-player {
  z-index: 20000 !important;
}

// showページのプレーヤー高さ
body.playlist-show-page .bottom-player {
  position: fixed !important;
  bottom: 50px !important;      /* デスクトップ時 */
  left: 0 !important;
  right: 0 !important;
  z-index: 2000 !important;
}

@media (max-width: 996px) {
  html body .bottom-player {
    position: fixed !important;  // ← static をねじ伏せる
    bottom: 80px !important;     // ← 上にずらしたい値
    left: 0 !important;
    right: 0 !important;
    z-index: 2000 !important;    // ← 必要なら
  }
}

/* ===== モバイル：プレイリスト“一覧”モーダル内は必ずタップ可 ===== */
#playlist-modal-mobile {
  #super-search-panel { pointer-events: auto !important; }
  #playlist-sidebar-home,
  .filter-box,
  a,
  button,
  .playlist-link {
    pointer-events: auto !important;
  }
}

/* モーダル中はフッターがタップを奪わないように（安全策） */
.modal-open .mobile-footer { pointer-events: none; }

/* ローディングカバーを隠している時はタップを邪魔しない（保険） */
#loading-overlay.view-hidden { pointer-events: none !important; }

/* === プレーヤー非表示フラグ用（問い合わせ・プロフィール編集など） === */
.no-player #bottom-player { display: none !important; }
.no-player #hidden-sc-player { display: none !important; }

/* フッタープレーヤーの高さぶんだけ下に余白を常に確保 */
:root { --footer-player-h: 84px; } /* 実高さに合わせて 76〜96px で調整可 */

.emotion-log-show {
  padding-bottom: calc(var(--footer-player-h) + env(safe-area-inset-bottom, 0px));
}

/* もし body に no-player が付くケースがあれば余白ゼロに戻す（保険） */
body.no-player .emotion-log-show { padding-bottom: 0 !important; }

/* ===== モバイル詳細ページ：ページネーションの固定化を禁止 & 中央寄せ ===== */
.emotion-log-show .pagination {
  position: static !important;   /* fixed/sticky を無効化 */
  inset: auto !important;        /* top/right/bottom/left を無効化 */
  float: none !important;
  display: flex;
  flex-wrap: wrap !important;
  justify-content: center !important;
  white-space: normal !important;
  gap: .25rem;
}

/* =========================================================
   JSが落ちてもモバイルを必ず表示させる緊急フォールバック
   - 768px以下は #mobile-view を強制表示
   - .view-hidden の抑え込みも含む（opacity/visibility等も反転）
   - preloadの黒画面も可視化に修正
   ========================================================= */

#desktop-view { display: block; }
#mobile-view  { display: none; }

@media (max-width: 768px) {
  /* ▼ 通常の切替（モバイル幅では必ずモバイルを出す） */
  #desktop-view { display: none !important; }
  #mobile-view  { display: block !important; }

  /* ▼ view-switcher 等が .view-hidden を付けても表示が消えないように上書き */
  #mobile-view.view-hidden {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
    height: auto !important;
    pointer-events: auto !important;
  }
  #desktop-view.view-hidden { display: none !important; }

  /* ▼ 補助クラスにも保険（既存の .mobile-only / .desktop-only と整合） */
  .desktop-only { display: none !important; }
  .mobile-only  { display: block !important; }
}

/* ▼ preloadで真っ黒のまま止まらないように可視化へ反転 */
html.preload body { visibility: visible !important; }

/* =========================================================
   ローディングカバー（screen-cover-loading）の安全な非表示
   ========================================================= */
#screen-cover-loading {
  position: fixed;
  inset: 0;
  z-index: 2147483000; /* 最上位 */
  display: flex;
  align-items: center;
  justify-content: center;
}
#screen-cover-loading.hide { opacity: 0; transition: opacity .2s ease; }
#screen-cover-loading.view-hidden { display: none !important; }

/* （参考）SoundCloud隠しiframeの保険 */
.hidden-frame { display: none !important; width: 0 !important; height: 0 !important; }
